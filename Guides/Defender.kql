## Summary KPIs (Card visuals)

```kql
DeviceInfo
| where Timestamp > ago(90d)
| where tostring(MitigationStatus) contains "true"
| summarize IsolationTime = min(Timestamp) by DeviceId
| join kind=inner (
    DeviceInfo
    | where Timestamp > ago(90d)
    | summarize arg_max(Timestamp, *) by DeviceId
) on DeviceId
| extend IsCurrentlyIsolated = tostring(MitigationStatus) contains "true"
| summarize 
    TotalIsolationsLast90Days = count(),
    CurrentlyIsolated = countif(IsCurrentlyIsolated),
    ReleasedDevices = countif(not(IsCurrentlyIsolated))
```

**Visuals:**
- ğŸ”’ Currently Isolated (big number)
- ğŸ“Š Total Isolations (90d)
- âœ… Released Devices
- â±ï¸ Average Isolation Duration

---

## Isolation Trend Over Time (Line/Area chart)

```kql
DeviceInfo
| where Timestamp > ago(90d)
| where tostring(MitigationStatus) contains "true"
| summarize IsolationTime = min(Timestamp) by DeviceId
| summarize IsolationsPerDay = dcount(DeviceId) by bin(IsolationTime, 1d)
| order by IsolationTime asc
```

Shows spikes in isolation activity â€” useful for identifying incidents or campaigns.

---

## Isolations by OS Platform (Pie/Donut chart)

```kql
DeviceInfo
| where Timestamp > ago(90d)
| where tostring(MitigationStatus) contains "true"
| summarize arg_max(Timestamp, *) by DeviceId
| summarize Count = count() by OSPlatform
| order by Count desc
```

---

## Isolations by Machine Group (Bar chart)

```kql
DeviceInfo
| where Timestamp > ago(90d)
| where tostring(MitigationStatus) contains "true"
| summarize arg_max(Timestamp, *) by DeviceId
| summarize Count = count() by MachineGroup
| order by Count desc
```

Helps identify which business units/departments are most affected.

---

## Isolation Duration Distribution (Histogram/Column chart)

```kql
// Reuse your main query, then bucket the durations
DeviceInfo
| where Timestamp > ago(90d)
| where tostring(MitigationStatus) contains "true"
| summarize IsolationTime = min(Timestamp) by DeviceId
| join kind=inner (
    DeviceInfo
    | where Timestamp > ago(90d)
    | summarize arg_max(Timestamp, *) by DeviceId
) on DeviceId
| extend IsCurrentlyIsolated = tostring(MitigationStatus) contains "true"
| extend DurationHours = datetime_diff('hour', iff(IsCurrentlyIsolated, now(), Timestamp), IsolationTime)
| extend DurationBucket = case(
    DurationHours < 1, "< 1 hour",
    DurationHours < 4, "1-4 hours",
    DurationHours < 24, "4-24 hours",
    DurationHours < 72, "1-3 days",
    DurationHours < 168, "3-7 days",
    "> 7 days"
)
| summarize Count = count() by DurationBucket
```

Shows operational efficiency â€” are devices sitting isolated for too long?

---

## Repeat Offenders (Table)

```kql
DeviceInfo
| where Timestamp > ago(90d)
| where tostring(MitigationStatus) contains "true"
| summarize IsolationCount = dcount(bin(Timestamp, 1d)) by DeviceId, DeviceName
| where IsolationCount > 1
| order by IsolationCount desc
| take 10
```

Devices that have been isolated multiple times â€” might indicate persistent issues.

---

## Exposure Level at Isolation (Stacked bar or Donut)

```kql
DeviceInfo
| where Timestamp > ago(90d)
| where tostring(MitigationStatus) contains "true"
| summarize arg_max(Timestamp, *) by DeviceId
| summarize Count = count() by ExposureLevel
| order by Count desc
```

Were high-exposure devices being isolated more often?

---

## Currently Isolated - Long Duration Alert (Table)

```kql
// Devices isolated for more than 3 days â€” may need attention
DeviceInfo
| where Timestamp > ago(90d)
| summarize arg_max(Timestamp, *) by DeviceId
| where tostring(MitigationStatus) contains "true"
| join kind=inner (
    DeviceInfo
    | where Timestamp > ago(90d)
    | where tostring(MitigationStatus) contains "true"
    | summarize IsolationTime = min(Timestamp) by DeviceId
) on DeviceId
| extend DurationDays = datetime_diff('day', now(), IsolationTime)
| where DurationDays > 3
| project DeviceName, IsolationTime, DurationDays, MachineGroup, PublicIP
| order by DurationDays desc
```

Actionable list for follow-up.

---

## Related Alerts for Isolated Devices (if you have AlertInfo/AlertEvidence)

```kql
let IsolatedDevices = DeviceInfo
| where Timestamp > ago(90d)
| where tostring(MitigationStatus) contains "true"
| distinct DeviceId;

AlertEvidence
| where Timestamp > ago(90d)
| where DeviceId in (IsolatedDevices)
| join kind=inner AlertInfo on AlertId
| summarize AlertCount = count() by Title, Severity
| order by AlertCount desc
```

Shows what alerts triggered on isolated devices â€” context for *why* they were isolated.

---

## Suggested Dashboard Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Currently Isolated]  [Total 90d]  [Released]  [Avg Duration]  â”‚  â† KPI Cards
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   [Isolation Trend Over Time - Line Chart]                      â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [By OS Platform - Donut]     â”‚ [By Machine Group - Bar]         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   [Main Device Table - your existing query]                     â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Duration Distribution]      â”‚ [Repeat Offenders]               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   [Long Duration Alert Table - needs attention]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
